<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NCERT Quiz</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family:'Baloo 2',sans-serif; background:#FFF8F0; min-height:100vh; }
.header { background:linear-gradient(135deg,#FF6B00,#FFB300); padding:14px; text-align:center; }
.header h1 { color:white; font-size:20px; font-weight:800; }
.header p { color:rgba(255,255,255,0.9); font-size:11px; }
.tabs { display:flex; gap:6px; padding:10px; overflow-x:auto; background:white; border-bottom:2px solid #F0E6D3; scrollbar-width:none; }
.tabs::-webkit-scrollbar{display:none;}
.tab { flex-shrink:0; padding:6px 14px; border:2px solid transparent; border-radius:20px; font-family:inherit; font-size:13px; font-weight:600; cursor:pointer; background:#F5F5F5; color:#666; transition:all 0.2s; }
.tab.active { background:#FF6B00; color:white; border-color:#E55A00; }
.classes { display:flex; gap:6px; padding:8px 10px; overflow-x:auto; background:white; border-bottom:1px solid #F0E6D3; scrollbar-width:none; }
.classes::-webkit-scrollbar{display:none;}
.cls { flex-shrink:0; padding:4px 12px; border:2px solid #DDD; border-radius:12px; font-family:inherit; font-size:12px; font-weight:600; cursor:pointer; background:white; color:#888; }
.cls.active { border-color:#0D47A1; background:#E3F2FD; color:#0D47A1; }
.stats { display:flex; justify-content:space-around; padding:8px; background:white; border-bottom:1px solid #F0E6D3; }
.stat { text-align:center; }
.sv { font-size:18px; font-weight:800; color:#FF6B00; }
.sv.g{color:#2E7D32;} .sv.r{color:#C62828;}
.sl { font-size:10px; color:#888; }
.premium { background:linear-gradient(135deg,#1A1A2E,#0D47A1); color:white; padding:8px 14px; display:flex; align-items:center; justify-content:space-between; font-size:11px; }
.pbtn { background:#FFB300; color:#333; border:none; padding:4px 12px; border-radius:20px; font-family:inherit; font-size:11px; font-weight:700; cursor:pointer; }
.main { padding:12px; }
.card { background:white; border-radius:16px; padding:16px; box-shadow:0 4px 20px rgba(255,107,0,0.15); border-left:5px solid #FF6B00; animation:up 0.3s ease; }
@keyframes up{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
.meta { display:flex; justify-content:space-between; margin-bottom:10px; }
.badge { background:#FFF3CD; color:#8B6914; font-size:11px; font-weight:700; padding:3px 10px; border-radius:20px; }
.etag { background:#E8EAF6; color:#3949AB; font-size:10px; font-weight:600; padding:3px 8px; border-radius:10px; }
.qhi { font-size:15px; font-weight:700; line-height:1.6; margin-bottom:6px; }
.qen { font-size:12px; color:#666; font-style:italic; margin-bottom:12px; padding-bottom:10px; border-bottom:1px dashed #EEE; }
.opts { display:flex; flex-direction:column; gap:8px; }
.opt { display:flex; align-items:center; gap:10px; padding:10px 14px; border:2px solid #E8E8E8; border-radius:12px; background:#FAFAFA; cursor:pointer; font-family:inherit; width:100%; transition:all 0.2s; text-align:left; }
.opt:hover:not(:disabled){border-color:#FF6B00;background:#FFF5EC;}
.ol { width:28px; height:28px; border-radius:50%; background:#F0F0F0; display:flex; align-items:center; justify-content:center; font-size:13px; font-weight:800; flex-shrink:0; color:#666; }
.ohi { font-size:13px; font-weight:600; }
.oen { font-size:11px; color:#888; font-style:italic; }
.opt.correct{border-color:#2E7D32;background:#E8F5E9;}
.opt.correct .ol{background:#2E7D32;color:white;}
.opt.wrong{border-color:#C62828;background:#FFEBEE;}
.opt.wrong .ol{background:#C62828;color:white;}
.opt.show{border-color:#2E7D32;background:#E8F5E9;opacity:0.8;}
.exp { margin-top:12px; padding:12px; background:#FFF8E1; border-radius:10px; border-left:4px solid #FFB300; display:none; }
.etitle { font-size:12px; font-weight:700; color:#7B5800; margin-bottom:6px; }
.ehi { font-size:13px; color:#5D4037; line-height:1.6; }
.een { font-size:11px; color:#795548; font-style:italic; margin-top:4px; }
.next { width:100%; padding:14px; background:linear-gradient(135deg,#FF6B00,#E55A00); color:white; border:none; border-radius:14px; font-family:inherit; font-size:16px; font-weight:800; cursor:pointer; margin-top:10px; display:none; box-shadow:0 4px 15px rgba(255,107,0,0.35); }
.next.show{display:block;}
.loader { text-align:center; padding:40px 20px; background:white; border-radius:16px; box-shadow:0 4px 20px rgba(255,107,0,0.15); }
.spin { display:inline-block; width:40px; height:40px; border:4px solid #FFE0CC; border-top-color:#FF6B00; border-radius:50%; animation:spin 0.8s linear infinite; margin-bottom:16px; }
@keyframes spin{to{transform:rotate(360deg)}}
.lt { color:#FF6B00; font-size:15px; font-weight:700; }
.err { background:#FFF3E0; border-radius:16px; padding:20px; text-align:center; border:2px solid #FFB300; display:none; }
.err.show{display:block;}
.rbtn { margin-top:12px; padding:10px 24px; background:#FF6B00; color:white; border:none; border-radius:10px; font-family:inherit; font-size:14px; font-weight:700; cursor:pointer; }
</style>
</head>
<body>
<div class="header">
  <h1>üéØ NCERT ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ Quiz</h1>
  <p>‡§ï‡§ï‡•ç‡§∑‡§æ 6-12 | ‡§á‡§§‡§ø‡§π‡§æ‡§∏ ‚Ä¢ ‡§≠‡•Ç‡§ó‡•ã‡§≤ ‚Ä¢ ‡§Ö‡§∞‡•ç‡§•‡§∂‡§æ‡§∏‡•ç‡§§‡•ç‡§∞ ‚Ä¢ ‡§∞‡§æ‡§ú‡§®‡•Ä‡§§‡§ø</p>
</div>
<div class="tabs">
  <button class="tab active" onclick="setSub(this,'‡§á‡§§‡§ø‡§π‡§æ‡§∏')">‚öîÔ∏è ‡§á‡§§‡§ø‡§π‡§æ‡§∏</button>
  <button class="tab" onclick="setSub(this,'‡§≠‡•Ç‡§ó‡•ã‡§≤')">üåç ‡§≠‡•Ç‡§ó‡•ã‡§≤</button>
  <button class="tab" onclick="setSub(this,'‡§Ö‡§∞‡•ç‡§•‡§∂‡§æ‡§∏‡•ç‡§§‡•ç‡§∞')">üìà ‡§Ö‡§∞‡•ç‡§•‡§∂‡§æ‡§∏‡•ç‡§§‡•ç‡§∞</button>
  <button class="tab" onclick="setSub(this,'‡§∞‡§æ‡§ú‡§®‡•Ä‡§§‡§ø‡§∂‡§æ‡§∏‡•ç‡§§‡•ç‡§∞')">üèõÔ∏è ‡§∞‡§æ‡§ú‡§®‡•Ä‡§§‡§ø</button>
  <button class="tab" onclick="setSub(this,'‡§Æ‡§ø‡§∂‡•ç‡§∞‡§ø‡§§')">üé≤ ‡§Æ‡§ø‡§∂‡•ç‡§∞‡§ø‡§§</button>
</div>
<div class="classes">
  <button class="cls active" onclick="setCls(this,'all')">‡§∏‡§≠‡•Ä</button>
  <button class="cls" onclick="setCls(this,'6')">6th</button>
  <button class="cls" onclick="setCls(this,'7')">7th</button>
  <button class="cls" onclick="setCls(this,'8')">8th</button>
  <button class="cls" onclick="setCls(this,'9')">9th</button>
  <button class="cls" onclick="setCls(this,'10')">10th</button>
  <button class="cls" onclick="setCls(this,'11')">11th</button>
  <button class="cls" onclick="setCls(this,'12')">12th</button>
</div>
<div class="stats">
  <div class="stat"><div class="sv" id="t">0</div><div class="sl">‡§ï‡•Å‡§≤</div></div>
  <div class="stat"><div class="sv g" id="c">0</div><div class="sl">‡§∏‡§π‡•Ä ‚úì</div></div>
  <div class="stat"><div class="sv r" id="w">0</div><div class="sl">‡§ó‡§≤‡§§ ‚úó</div></div>
  <div class="stat"><div class="sv" id="s">0üî•</div><div class="sl">‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä‡§ï</div></div>
</div>
<div class="premium">
  <span>‚ú® Premium: Unlimited MCQs + PDF Notes</span>
  <button class="pbtn" onclick="alert('‚Çπ99/‡§Æ‡§æ‡§π\nContact: @your_username')">‚Çπ99/‡§Æ‡§æ‡§π</button>
</div>
<div class="main">
  <div class="loader" id="loader"><div class="spin"></div><div class="lt">‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</div></div>
  <div class="err" id="err"><div style="font-size:32px">‚ö†Ô∏è</div><div style="font-weight:700;margin:8px 0">‡§ï‡•Å‡§õ ‡§ó‡§°‡§º‡§¨‡§°‡§º ‡§π‡•Å‡§à</div><div id="emsg" style="font-size:13px;color:#666"></div><button class="rbtn" onclick="load()">üîÑ ‡§¶‡•ã‡§¨‡§æ‡§∞‡§æ ‡§ï‡•ã‡§∂‡§ø‡§∂</button></div>
  <div class="card" id="card" style="display:none">
    <div class="meta"><span class="badge" id="qb"></span><span class="etag" id="qt"></span></div>
    <div class="qhi" id="qh"></div>
    <div class="qen" id="qe"></div>
    <div class="opts" id="opts"></div>
    <div class="exp" id="exp"><div class="etitle">üí° ‡§µ‡•ç‡§Ø‡§æ‡§ñ‡•ç‡§Ø‡§æ | Explanation</div><div class="ehi" id="eh"></div><div class="een" id="ee"></div></div>
    <button class="next" id="next" onclick="load()">‡§Ö‡§ó‡§≤‡§æ ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‚Üí Next Question</button>
  </div>
</div>
<script>
const KEY = "AIzaSyAKji440cnc0OVu9A0SbWSKkFFbPR54viI";
let sub='‡§á‡§§‡§ø‡§π‡§æ‡§∏', cls='all', done=false, cur=null;
let stats={t:0,c:0,w:0,s:0};

if(window.Telegram?.WebApp){Telegram.WebApp.ready();Telegram.WebApp.expand();}
window.onload=()=>load();

function setSub(b,s){document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));b.classList.add('active');sub=s;if(!done)load();}
function setCls(b,c){document.querySelectorAll('.cls').forEach(x=>x.classList.remove('active'));b.classList.add('active');cls=c;if(!done)load();}

async function load(){
  done=false;
  document.getElementById('next').classList.remove('show');
  document.getElementById('card').style.display='none';
  document.getElementById('err').classList.remove('show');
  document.getElementById('loader').style.display='block';
  try{const q=await getQ();show(q);}
  catch(e){
    document.getElementById('loader').style.display='none';
    document.getElementById('err').classList.add('show');
    document.getElementById('emsg').textContent=e.message;
  }
}

async function getQ(){
  const ct=cls==='all'?'‡§ï‡§ï‡•ç‡§∑‡§æ 6 ‡§∏‡•á 12':`‡§ï‡§ï‡•ç‡§∑‡§æ ${cls}`;
  const seed=Math.floor(Math.random()*9999);
  const prompt=`NCERT ${sub} ${ct} ‡§∏‡•á ‡§è‡§ï MCQ ‡§¨‡§®‡§æ‡§ì ‡§ú‡•ã UPSC/SSC/Railway ‡§Æ‡•á‡§Ç ‡§™‡•Ç‡§õ‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•ã‡•§
‡§ï‡•á‡§µ‡§≤ ‡§Ø‡§π JSON ‡§¶‡•ã, ‡§ï‡•Å‡§õ ‡§î‡§∞ ‡§®‡§π‡•Ä‡§Ç:
{"class":"‡§ï‡§ï‡•ç‡§∑‡§æ 9","exam_tag":"SSC 2022","q_hi":"‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§™‡•ç‡§∞‡§∂‡•ç‡§®","q_en":"English question","options":[{"letter":"A","hi":"‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ A","en":"Option A"},{"letter":"B","hi":"‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ B","en":"Option B"},{"letter":"C","hi":"‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ C","en":"Option C"},{"letter":"D","hi":"‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ D","en":"Option D"}],"correct":"B","exp_hi":"‡§µ‡•ç‡§Ø‡§æ‡§ñ‡•ç‡§Ø‡§æ","exp_en":"Explanation"}
Seed:${seed}`;

  const r=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=${KEY}`,{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({contents:[{parts:[{text:prompt}]}],generationConfig:{temperature:0.9,maxOutputTokens:800}})
  });
  if(!r.ok)throw new Error('API Error: '+r.status);
  const d=await r.json();
  const txt=d.candidates[0].content.parts[0].text;
  const m=txt.match(/\{[\s\S]*\}/);
  if(!m)throw new Error('Parse error');
  return JSON.parse(m[0]);
}

function show(q){
  cur=q;
  document.getElementById('loader').style.display='none';
  document.getElementById('card').style.display='block';
  document.getElementById('exp').style.display='none';
  document.getElementById('qb').textContent=`${q.class} | ${sub}`;
  document.getElementById('qt').textContent=q.exam_tag||'UPSC/SSC';
  document.getElementById('qh').textContent=q.q_hi;
  document.getElementById('qe').textContent=q.q_en;
  const o=document.getElementById('opts');
  o.innerHTML='';
  q.options.forEach(opt=>{
    const b=document.createElement('button');
    b.className='opt';
    b.innerHTML=`<div class="ol">${opt.letter}</div><div><div class="ohi">${opt.hi}</div><div class="oen">${opt.en}</div></div>`;
    b.onclick=()=>ans(opt.letter,q.correct,b);
    o.appendChild(b);
  });
}

function ans(sel,cor,btn){
  if(done)return;
  done=true;
  stats.t++;
  document.querySelectorAll('.opt').forEach(b=>b.disabled=true);
  if(sel===cor){btn.classList.add('correct');stats.c++;stats.s++;if(Telegram?.WebApp?.HapticFeedback)Telegram.WebApp.HapticFeedback.notificationOccurred('success');}
  else{btn.classList.add('wrong');stats.s=0;document.querySelectorAll('.opt').forEach(b=>{if(b.querySelector('.ol').textContent===cor)b.classList.add('show');});if(Telegram?.WebApp?.HapticFeedback)Telegram.WebApp.HapticFeedback.notificationOccurred('error');}
  document.getElementById('t').textContent=stats.t;
  document.getElementById('c').textContent=stats.c;
  document.getElementById('w').textContent=stats.w=(stats.t-stats.c);
  document.getElementById('s').textContent=stats.s+'üî•';
  document.getElementById('eh').textContent=cur.exp_hi;
  document.getElementById('ee').textContent=cur.exp_en;
  document.getElementById('exp').style.display='block';
  document.getElementById('next').classList.add('show');
}
</script>
</body>
</html>
